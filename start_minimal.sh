#!/bin/bash
# é‡åŒ–äº¤æ˜“ç³»ç»Ÿæœ€å°åŒ–å¯åŠ¨è„šæœ¬
# ä»…å¯åŠ¨æ ¸å¿ƒç»„ä»¶ï¼Œé€‚åˆèµ„æºå—é™çš„ç¯å¢ƒ

echo "ğŸš€ å¯åŠ¨é‡åŒ–äº¤æ˜“ç³»ç»Ÿ2.0 (æœ€å°åŒ–æ¨¡å¼)..."

# è®¾ç½®å·¥ä½œç›®å½•
cd "$(dirname "$0")"

# åˆ›å»ºå¿…è¦çš„ç›®å½•
mkdir -p logs data backups

# æ£€æŸ¥æ•°æ®åº“å’Œé…ç½®æ–‡ä»¶
if [ ! -f "quantitative.db" ]; then
    echo "âš ï¸ è­¦å‘Š: æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯·ç¡®ä¿å·²åˆå§‹åŒ–æ•°æ®åº“"
fi

if [ ! -f "auto_trading_config.json" ]; then
    echo "âš ï¸ è­¦å‘Š: é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°†ä½¿ç”¨é»˜è®¤é…ç½®"
fi

# å¯åŠ¨ç¨³å®šæ€§ç›‘æ§ (åå°è¿è¡Œ)
echo "å¯åŠ¨ç³»ç»Ÿç¨³å®šæ€§ç›‘æ§..."
python3 stability_monitor.py > logs/stability_monitor.log 2>&1 &
sleep 2

# å¯åŠ¨è‡ªåŠ¨äº¤æ˜“å¼•æ“ (åå°è¿è¡Œ)
echo "å¯åŠ¨è‡ªåŠ¨äº¤æ˜“å¼•æ“..."
python3 auto_trading_engine.py > logs/auto_trading_engine.log 2>&1 &
sleep 2

# æ˜¾ç¤ºè¿è¡ŒçŠ¶æ€
echo "ç³»ç»Ÿå·²å¯åŠ¨ï¼Œæ£€æŸ¥çŠ¶æ€..."
python3 start_auto_trading.py --status

echo ""
echo "====================================================="
echo "ğŸ‰ é‡åŒ–äº¤æ˜“ç³»ç»Ÿå·²åœ¨æœ€å°åŒ–æ¨¡å¼ä¸‹å¯åŠ¨"
echo "ğŸ“Š ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹è¿è¡ŒçŠ¶æ€:"
echo "    python3 start_auto_trading.py --status"
echo "ğŸ’¡ ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœæ­¢ç³»ç»Ÿ:"
echo "    python3 start_auto_trading.py --stop"
echo "=====================================================" 