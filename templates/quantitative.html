<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>校长的量化系统 - 量化交易</title>
    <!-- 添加favicon -->
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/logo.png') }}">
    <!-- 替换为更稳定的CDN -->
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.2.3/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.3.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <!-- 引用量化交易专用样式 -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/quantitative.css') }}">
    <script src="https://cdn.bootcdn.net/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg" style="background: linear-gradient(135deg, #1677ff, #4096ff);">
            <div class="container-fluid">
                <div class="navbar-content">
                    <!-- 左侧：品牌名和系统状态 -->
                    <div class="navbar-left">
                        <div class="navbar-brand-group">
                            <a class="navbar-brand" href="/">
                                <i class="fas fa-chart-line"></i>
                                校长的量化系统
                            </a>
                            <div class="system-status">
                                <span class="status-indicator status-offline" id="system-status-indicator"></span>
                                <span id="system-status-text">离线</span>
                                <span id="current-time">2025/6/4 05:05:27</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 右侧：导航菜单 -->
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link" href="/">
                                <i class="fas fa-home"></i>
                                <span class="nav-link-desktop-text">市场数据</span>
                                <span class="nav-link-mobile-text">市场</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="/quantitative.html">
                                <i class="fas fa-robot"></i>
                                <span class="nav-link-desktop-text">量化交易</span>
                                <span class="nav-link-mobile-text">量化</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/arbitrage.html">
                                <i class="fas fa-exchange-alt"></i>
                                <span class="nav-link-desktop-text">套利系统</span>
                                <span class="nav-link-mobile-text">套利</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/operations-log.html">
                                <i class="fas fa-list-alt"></i>
                                <span class="nav-link-desktop-text">操作日志</span>
                                <span class="nav-link-mobile-text">日志</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <div class="container-fluid mt-4">
        <!-- 顶部控制面板 -->
        <div class="row mb-4">
            <!-- 系统控制台 -->
            <div class="col-md-4 mb-3">
                <div class="card system-control-card h-100">
                    <div class="card-body">
                        <h5 class="card-title">
                            <i class="fas fa-cog"></i> 系统控制台
                        </h5>
                        
                        <!-- 系统状态 -->
                        <div class="mb-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <span>系统状态</span>
                                <span id="systemStatus">
                                    <span class="status-indicator status-offline"></span>
                                    离线
                                </span>
                            </div>
                        </div>
                        
                        <!-- 系统启停控制 -->
                        <div class="mb-3" data-system="quantitative">
                            <div class="d-flex justify-content-between align-items-center">
                                <span>量化系统</span>
                                <button id="systemToggle" class="btn-toggle" onclick="toggleSystem()">
                                </button>
                            </div>
                        </div>
                        
                        <!-- 自动交易开关 -->
                        <div class="mb-3" data-system="auto-trading">
                            <div class="d-flex justify-content-between align-items-center">
                                <span>真实交易</span>
                                <button id="autoTradingToggle" class="btn-toggle" onclick="toggleAutoTrading()">
                                </button>
                            </div>
                        </div>
                        
                        <!-- 策略管理 -->
                        <div class="mb-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <span>策略管理</span>
                                <button class="btn btn-sm btn-outline-light" onclick="showStrategyManagement()">
                                    <i class="fas fa-cogs"></i> 配置
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 账户总览 -->
            <div class="col-md-4 mb-3">
                <div class="card account-card h-100">
                    <div class="card-body">
                        <h5 class="card-title">
                            <i class="fas fa-wallet"></i> 账户总览
                        </h5>
                        
                        <div class="row text-center">
                            <div class="col-6">
                                <div class="metric-value" id="totalBalance">-</div>
                                <div class="metric-label">总资产</div>
                            </div>
                            <div class="col-6">
                                <div class="metric-value text-success" id="dailyPnl">-</div>
                                <div class="metric-label">今日盈亏</div>
                            </div>
                        </div>
                        
                        <hr style="border-color: rgba(255,255,255,0.3);">
                        
                        <div class="row text-center">
                            <div class="col-6">
                                <div class="metric-value" id="dailyReturn">-</div>
                                <div class="metric-label">今日收益率</div>
                            </div>
                            <div class="col-6">
                                <div class="metric-value" id="dailyTrades">-</div>
                                <div class="metric-label">今日交易</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 交易所状态 -->
            <div class="col-md-4 mb-3">
                <div class="card exchange-card h-100">
                    <div class="card-body">
                        <h5 class="card-title">
                            <i class="fas fa-link"></i> 交易所状态
                        </h5>
                        
                        <div id="exchangeStatus">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span>
                                    <span class="status-indicator status-online"></span>
                                    币安 (Binance)
                                </span>
                                <small>25ms</small>
                            </div>
                            
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span>API权限</span>
                                <span class="badge bg-success">现货交易</span>
                            </div>
                            
                            <div class="d-flex justify-content-between align-items-center">
                                <span>最后更新</span>
                                <small id="lastUpdate">刚刚</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 策略管理 -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">
                            <i class="fas fa-brain"></i> 量化策略管理
                        </h5>
                        <div class="d-flex align-items-center">
                            <!-- 策略进化滚动日志 -->
                            <div class="evolution-log-container me-3">
                                <div class="evolution-log-header">
                                    <i class="fas fa-chart-line text-primary me-1"></i>
                                    <small class="text-muted">策略进化日志</small>
                                </div>
                                <div class="evolution-log-content" id="evolutionLog">
                                    <div class="evolution-log-ticker" id="evolutionTicker">
                                        <!-- 滚动日志内容将通过JavaScript动态加载 -->
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-outline-info btn-sm" onclick="showAllLogs()" title="查看全部日志">
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="row" id="strategiesContainer">
                            <!-- 策略卡片将通过JavaScript动态生成 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 实时监控 -->
        <div class="row mb-4">
            <!-- 持仓监控 -->
            <div class="col-md-6 mb-3">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">
                            <i class="fas fa-coins"></i> 当前持仓
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>交易对</th>
                                        <th>数量</th>
                                        <th>均价</th>
                                        <th>浮盈</th>
                                    </tr>
                                </thead>
                                <tbody id="positionsTable">
                                    <tr>
                                        <td colspan="4" class="text-center text-muted">暂无持仓</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 交易信号 -->
            <div class="col-md-6 mb-3">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">
                            <i class="fas fa-signal"></i> 最新信号
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>时间</th>
                                        <th>交易对</th>
                                        <th>信号</th>
                                        <th>置信度</th>
                                    </tr>
                                </thead>
                                <tbody id="signalsTable">
                                    <tr>
                                        <td colspan="4" class="text-center text-muted">暂无信号</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 收益曲线图 -->
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">
                            <i class="fas fa-chart-line"></i> 收益曲线
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="performance-chart">
                            <canvas id="performanceChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <i class="fas fa-chart-area"></i> 资产增长历程
                        </h6>
                        <div>
                            <button class="btn btn-sm btn-outline-primary" onclick="app.toggleBalanceChart('30')">30天</button>
                            <button class="btn btn-sm btn-outline-primary active" onclick="app.toggleBalanceChart('90')">90天</button>
                            <button class="btn btn-sm btn-outline-primary" onclick="app.toggleBalanceChart('365')">1年</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="balance-chart">
                            <canvas id="balanceChart"></canvas>
                        </div>
                        
                        <!-- 里程碑展示 -->
                        <div class="milestones mt-3">
                            <div class="row text-center">
                                <div class="col-4">
                                    <div class="milestone-item">
                                        <div class="milestone-value text-success">10U</div>
                                        <div class="milestone-label">起始资金</div>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="milestone-item">
                                        <div class="milestone-value text-warning" id="currentBalance">9.7U</div>
                                        <div class="milestone-label">当前资产</div>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="milestone-item">
                                        <div class="milestone-value text-primary">100,000U</div>
                                        <div class="milestone-label">目标资产</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 策略配置弹窗模态框 -->
    <div class="modal fade" id="strategyConfigModal" tabindex="-1" aria-labelledby="strategyConfigModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="strategyConfigModalLabel">
                        <i class="fas fa-cog"></i> 策略配置
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="strategyConfigForm">
                        <input type="hidden" id="strategyId" name="strategyId">
                        
                        <!-- 基本信息 -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="strategyName" class="form-label">策略名称</label>
                                <input type="text" class="form-control" id="strategyName" name="strategyName" required>
                            </div>
                            <div class="col-md-6">
                                <label for="strategySymbol" class="form-label">交易对</label>
                                <select class="form-select" id="strategySymbol" name="strategySymbol" required>
                                    <option value="BTC/USDT">BTC/USDT</option>
                                    <option value="ETH/USDT">ETH/USDT</option>
                                    <option value="ADA/USDT">ADA/USDT</option>
                                    <option value="SOL/USDT">SOL/USDT</option>
                                    <option value="DOGE/USDT">DOGE/USDT</option>
                                    <option value="XRP/USDT">XRP/USDT</option>
                                </select>
                            </div>
                        </div>

                        <!-- 策略类型 -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="strategyType" class="form-label">策略类型</label>
                                <select class="form-select" id="strategyType" name="strategyType" disabled>
                                    <option value="momentum">动量策略</option>
                                    <option value="mean_reversion">均值回归</option>
                                    <option value="breakout">突破策略</option>
                                    <option value="grid_trading">网格交易</option>
                                    <option value="high_frequency">高频交易</option>
                                    <option value="trend_following">趋势跟踪</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="strategyEnabled" class="form-label">策略状态</label>
                                <div class="form-check form-switch mt-2">
                                    <input class="form-check-input" type="checkbox" role="switch" id="strategyEnabled" name="strategyEnabled">
                                    <label class="form-check-label" for="strategyEnabled">启用策略</label>
                                </div>
                            </div>
                        </div>

                        <!-- 策略参数 -->
                        <div class="card mb-3">
                            <div class="card-header">
                                <h6 class="mb-0">策略参数</h6>
                            </div>
                            <div class="card-body">
                                <div id="strategyParameters">
                                    <!-- 动态参数表单将在这里生成 -->
                                </div>
                            </div>
                        </div>

                        <!-- 策略统计 -->
                        <div class="card mb-3">
                            <div class="card-header">
                                <h6 class="mb-0">策略统计</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="text-center">
                                            <div class="h5 mb-1" id="strategyTotalReturn">-</div>
                                            <small class="text-muted">总收益率</small>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="text-center">
                                            <div class="h5 mb-1" id="strategyWinRate">-</div>
                                            <small class="text-muted">成功率</small>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="text-center">
                                            <div class="h5 mb-1" id="strategyTotalTrades">-</div>
                                            <small class="text-muted">交易次数</small>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="text-center">
                                            <div class="h5 mb-1" id="strategyDailyReturn">-</div>
                                            <small class="text-muted">日收益率</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="saveStrategyConfig">保存配置</button>
                    <button type="button" class="btn btn-warning" id="resetStrategyParams">重置参数</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 策略日志弹窗 -->
    <div class="modal fade" id="strategyLogsModal" tabindex="-1" aria-labelledby="strategyLogsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="strategyLogsModalLabel">
                        <i class="fas fa-history"></i> 策略日志
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- 日志类型选择 -->
                    <ul class="nav nav-tabs mb-3" id="logsTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="trade-logs-tab" data-bs-toggle="tab" data-bs-target="#trade-logs" type="button" role="tab">
                                <i class="fas fa-exchange-alt"></i> 交易日志
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="optimization-logs-tab" data-bs-toggle="tab" data-bs-target="#optimization-logs" type="button" role="tab">
                                <i class="fas fa-wrench"></i> 优化记录
                            </button>
                        </li>
                    </ul>

                    <div class="tab-content" id="logsTabContent">
                        <!-- 交易日志 -->
                        <div class="tab-pane fade show active" id="trade-logs" role="tabpanel">
                            <div class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>时间</th>
                                            <th>信号类型</th>
                                            <th>价格</th>
                                            <th>数量</th>
                                            <th>置信度</th>
                                            <th>执行状态</th>
                                            <th>盈亏</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tradeLogsTable">
                                        <tr>
                                            <td colspan="7" class="text-center text-muted">暂无交易记录</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- 优化记录 -->
                        <div class="tab-pane fade" id="optimization-logs" role="tabpanel">
                            <div class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>时间</th>
                                            <th>优化类型</th>
                                            <th>修改前参数</th>
                                            <th>修改后参数</th>
                                            <th>触发原因</th>
                                            <th>目标成功率</th>
                                        </tr>
                                    </thead>
                                    <tbody id="optimizationLogsTable">
                                        <tr>
                                            <td colspan="6" class="text-center text-muted">暂无优化记录</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <!-- 分页控件 -->
                            <div id="logPaginationContainer" class="mt-3">
                                <!-- 分页按钮将在这里动态生成 -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-info" id="exportLogs">导出日志</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 策略管理配置弹窗 -->
    <div class="modal fade" id="strategyManagementModal" tabindex="-1" aria-labelledby="strategyManagementModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="strategyManagementModalLabel">
                        <i class="fas fa-cogs"></i> 策略管理配置
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="strategyManagementForm">
                        <!-- 策略进化配置 -->
                        <div class="card mb-3">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="fas fa-dna"></i> 策略进化配置
                                </h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label for="evolutionInterval" class="form-label">进化更新间隔 (分钟)</label>
                                        <input type="number" class="form-control" id="evolutionInterval" value="10" min="1" max="60">
                                        <div class="form-text">策略自动进化和创建新策略的间隔时间</div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="maxStrategies" class="form-label">最大策略数量</label>
                                        <input type="number" class="form-control" id="maxStrategies" value="20" min="5" max="100">
                                        <div class="form-text">系统同时运行的最大策略数量</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 策略标准配置 -->
                        <div class="card mb-3">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="fas fa-trophy"></i> 策略交易标准
                                </h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <label for="realTradingScore" class="form-label">真实交易分值门槛</label>
                                        <input type="number" class="form-control" id="realTradingScore" value="65" min="50" max="100" step="0.1">
                                        <div class="form-text">策略达到此分值自动进行真实交易</div>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="realTradingCount" class="form-label">真实交易策略数量</label>
                                        <input type="number" class="form-control" id="realTradingCount" value="2" min="1" max="10">
                                        <div class="form-text">开启真实交易时选择前几名策略</div>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="validationAmount" class="form-label">验证交易金额 (USDT)</label>
                                        <input type="number" class="form-control" id="validationAmount" value="50" min="10" max="500" step="10">
                                        <div class="form-text">策略验证交易的单笔金额</div>
                                    </div>
                                </div>
                                <div class="row mt-3">
                                    <div class="col-md-4">
                                        <label for="minTrades" class="form-label">最少交易次数</label>
                                        <input type="number" class="form-control" id="minTrades" value="10" min="1" max="100">
                                        <div class="form-text">策略进入真实交易的最少交易次数</div>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="minWinRate" class="form-label">最低胜率 (%)</label>
                                        <input type="number" class="form-control" id="minWinRate" value="65" min="50" max="95" step="0.1">
                                        <div class="form-text">策略进入真实交易的最低胜率要求</div>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="realTradingAmount" class="form-label">真实交易金额 (USDT)</label>
                                        <input type="number" class="form-control" id="realTradingAmount" value="100" min="50" max="1000" step="10">
                                        <div class="form-text">真实交易的单笔交易金额</div>
                                    </div>
                                </div>
                                <div class="row mt-3">
                                    <div class="col-md-4">
                                        <label for="minProfit" class="form-label">最低收益 (USDT)</label>
                                        <input type="number" class="form-control" id="minProfit" value="0" min="0" step="0.01">
                                        <div class="form-text">策略进入真实交易的最低总收益</div>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="maxDrawdown" class="form-label">最大回撤 (%)</label>
                                        <input type="number" class="form-control" id="maxDrawdown" value="10" min="1" max="50" step="0.1">
                                        <div class="form-text">策略允许的最大回撤率</div>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="minSharpeRatio" class="form-label">最低夏普比率</label>
                                        <input type="number" class="form-control" id="minSharpeRatio" value="1.0" min="0" max="5" step="0.1">
                                        <div class="form-text">策略的最低夏普比率要求</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 风险管理配置 -->
                        <div class="card mb-3">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="fas fa-shield-alt"></i> 风险管理配置
                                </h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <label for="maxPositionSize" class="form-label">最大仓位 (USDT)</label>
                                        <input type="number" class="form-control" id="maxPositionSize" value="100" min="10" max="10000" step="10">
                                        <div class="form-text">单个策略的最大仓位金额</div>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="stopLossPercent" class="form-label">止损百分比 (%)</label>
                                        <input type="number" class="form-control" id="stopLossPercent" value="5" min="1" max="20" step="0.1">
                                        <div class="form-text">全局止损触发的亏损百分比</div>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="takeProfitPercent" class="form-label">止盈百分比 (%)</label>
                                        <input type="number" class="form-control" id="takeProfitPercent" value="4" min="1" max="15" step="0.1">
                                        <div class="form-text">全局止盈触发的盈利百分比</div>
                                    </div>
                                </div>
                                <div class="row mt-3">
                                    <div class="col-md-6">
                                        <label for="maxHoldingMinutes" class="form-label">最大持仓时间 (分钟)</label>
                                        <input type="number" class="form-control" id="maxHoldingMinutes" value="30" min="5" max="120" step="5">
                                        <div class="form-text">超过此时间且有盈利将触发时间止盈</div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="minProfitForTimeStop" class="form-label">时间止盈最低收益 (%)</label>
                                        <input type="number" class="form-control" id="minProfitForTimeStop" value="1" min="0.1" max="5" step="0.1">
                                        <div class="form-text">时间止盈触发的最低收益率</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 策略淘汰配置 -->
                        <div class="card mb-3">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="fas fa-trash-alt"></i> 策略淘汰配置
                                </h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label for="eliminationDays" class="form-label">淘汰周期 (天)</label>
                                        <input type="number" class="form-control" id="eliminationDays" value="7" min="1" max="30">
                                        <div class="form-text">策略表现评估和淘汰的周期</div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="minScore" class="form-label">最低评分</label>
                                        <input type="number" class="form-control" id="minScore" value="50" min="0" max="100" step="0.1">
                                        <div class="form-text">策略保留的最低评分标准</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-warning" id="resetManagementConfig">恢复默认</button>
                    <button type="button" class="btn btn-primary" id="saveManagementConfig">保存配置</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.2.3/js/bootstrap.bundle.min.js"></script>
    <script>
        // 更新当前时间
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            const timeElement = document.getElementById('current-time');
            if (timeElement) {
                timeElement.textContent = timeString;
            }
        }

        // 页面加载时立即更新时间和状态
        updateCurrentTime();
        
        // 确保页面加载时状态指示器显示正确
        const statusIndicator = document.getElementById('system-status-indicator');
        const statusText = document.getElementById('system-status-text');
        if (statusIndicator && statusText) {
            statusIndicator.className = 'status-indicator status-offline';
            statusText.textContent = '离线';
        }
        
        // 每秒更新时间
        setInterval(updateCurrentTime, 1000);
    </script>
    <script src="{{ url_for('static', filename='js/quantitative.js') }}"></script>
</body>
</html> 