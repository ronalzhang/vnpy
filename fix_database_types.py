#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n\"\"\"\næ•°æ®åº“å­—æ®µç±»å‹ä¿®å¤è„šæœ¬\nä¿®å¤PostgreSQLä¸­çš„å­—æ®µç±»å‹é—®é¢˜\n\"\"\"\n\nimport psycopg2\n\ndef fix_database_types():\n    conn = psycopg2.connect(\n        host='localhost',\n        database='quantitative',\n        user='quant_user',\n        password='chenfei0421'\n    )\n    conn.autocommit = True\n    cursor = conn.cursor()\n    \n    print(\"ğŸ”§ ä¿®å¤æ•°æ®åº“å­—æ®µç±»å‹...\")\n    \n    try:\n        # 1. ä¿®å¤ trading_signals è¡¨çš„ executed å­—æ®µ\n        cursor.execute(\"\"\"\n            ALTER TABLE trading_signals \n            ALTER COLUMN executed TYPE boolean \n            USING executed::boolean\n        \"\"\")\n        print(\"âœ… trading_signals.executed å­—æ®µç±»å‹å·²ä¿®å¤ä¸º boolean\")\n        \n    except Exception as e:\n        print(f\"âš ï¸ ä¿®å¤ trading_signals.executed å¤±è´¥: {e}\")\n    \n    try:\n        # 2. æ£€æŸ¥å…¶ä»–å¯èƒ½çš„ç±»å‹é—®é¢˜\n        cursor.execute(\"\"\"\n            SELECT column_name, data_type \n            FROM information_schema.columns \n            WHERE table_name = 'trading_signals'\n        \"\"\")\n        \n        columns = cursor.fetchall()\n        print(\"\\nğŸ“Š trading_signals è¡¨ç»“æ„:\")\n        for col, dtype in columns:\n            print(f\"   {col}: {dtype}\")\n            \n    except Exception as e:\n        print(f\"âš ï¸ æ£€æŸ¥è¡¨ç»“æ„å¤±è´¥: {e}\")\n    \n    try:\n        # 3. ä¿®å¤ strategy_trade_logs ä¸­å¯èƒ½çš„å­—æ®µé—®é¢˜\n        cursor.execute(\"\"\"\n            SELECT column_name, data_type \n            FROM information_schema.columns \n            WHERE table_name = 'strategy_trade_logs'\n            AND column_name IN ('executed', 'is_real_money')\n        \"\"\")\n        \n        trade_columns = cursor.fetchall()\n        print(\"\\nğŸ“Š strategy_trade_logs ç›¸å…³å­—æ®µ:\")\n        for col, dtype in trade_columns:\n            print(f\"   {col}: {dtype}\")\n            \n    except Exception as e:\n        print(f\"âš ï¸ æ£€æŸ¥äº¤æ˜“æ—¥å¿—è¡¨å¤±è´¥: {e}\")\n    \n    conn.close()\n    print(\"\\nâœ… æ•°æ®åº“ç±»å‹ä¿®å¤å®Œæˆ\")\n\nif __name__ == \"__main__\":\n    fix_database_types() 